# Домашнее задание к занятию «Внесение изменений в конфигурацию на поддержке»

## Цель задания

1. Научиться правильно вносить корректировки в конфигурации 1С, стоящие на поддержке поставщика.
2. Научиться вносить изменения в конфигурацию, находящуюся на поддержке поставщика.

Эта практика научит вас корректному внесению доработок в конфигурацию 1С, стоящую на поддержке поставщика. Эти навыки пригодятся для реальной работы, когда вам потребуется внести объёмные доработки в конфигурацию.

## Чеклист готовности к домашнему заданию

- [ ] Установить платформу версии 8.3.27 или больше.
- [ ] Просмотреть материал занятия «Внесение изменений в конфигурацию на поддержке».

## Инструкция к заданию

1. Решите описанные задачи в конфигураторе.
2. Протестируйте решение в пользовательском режиме.
3. Отправьте на проверку в личном кабинете Нетологии один общий файл базы данных (.dt), содержащей решения по обеим задачам. Файл прикрепите в раздел «решение» в практическом задании.

## Задача 1. «Добавление объектов метаданных в конфигурацию, стоящую на поддержке»

### Описание задачи
Вы дорабатываете приложение заказчика, использующего конфигурацию на полной поддержке. Заказчик запросил доработку: для Контрагентов необходимо хранить список контактных лиц.

### Требования к результату
Задание аналогично первой задаче прошлого занятия, но в этом случае необходимо сделать всё то же самое без использования расширения, внося корректировки в конфигурацию.
В этом задании основной проверяемый критерий — правильность внесения доработок.
Технические требования к реализации и порядок решения приведены в [прошлом домашнем задании](homework-11-1.md). 
Дополнительное требование — формы надо дорабатывать исключительно программно.

### Процесс выполнения
1. Сохраните результат прошлого домашнего решения в отдельный dt-файл. Он пригодится для следующего домашнего задания.
2. После сохранения файла удалите из базы расширение.
<details>
  <summary>Подсказка 1</summary>
  Откройте список расширений. Снимите напротив расширения флаг «Активно». Удалите его.
</details>


3. Включите для конфигурации возможность изменения.
<details>
  <summary>Подсказка 2</summary>
  Включите возможность изменения, но не забудьте оставить для всех объектов настройку «Объект поставщика не редактируется».
</details>
 

4. Подумайте, для каких объектов необходимо включить возможность изменения и включите её. Не бойтесь что-то забыть, к этой настройке всегда можно вернуться.
<details>
  <summary>Подсказка 3</summary>
  Мы будем добавлять объекты-справочники, значит, надо разрешить редактировать корень конфигурации и подсистемы, в которые справочники будут включены.
  
  Также нам надо вносить изменения в документы (добавить для них реквизиты) и в формы документов (но тут есть одна хитрость, о ней — в одной из подсказок далее).
</details>
<details>
  <summary>Подсказка 4</summary>
  Не выбирайте пункт «Объект поставщика снят с поддержки». Используйте «Объект редактируется с сохранением поддержки».
  
  Также не устанавливайте флаг «Установить для подчинённых», если это не необходимо. Настраивайте объекты максимально точечно.
</details>
5. Добавьте объекты, необходимые для решения задачи.

Так как мы создаём новые справочники, они будут пустыми. Если в прошлой базе вы создали много данных, попробуйте перенести их при помощи выгрузки из той базы и загрузку в эту (например, при помощи JSON).
<details>
  <summary>Подсказка 6</summary>
  В общем случае, объекты можно скопировать из расширения, например, открыть его в соседней конфигурации и копировать их. Но следите за тем, чтобы типы данных не сбивались. Например, если вы скопируете сначала справочник Контактные лица, а потом справочник с должностями, то у реквизита Должность справочника КонтактныеЛица собьётся тип данных (будет установлена строка 10 символов), потому что на момент добавления этого справочника типа СправочникСсылка.Должности в конфигурации не будет.

  Также для справочников придётся указать подсистемы, в которые вы их размещаете.
</details>


6. Пропишите необходимый программный код.
<details>
  <summary>Подсказка 7</summary>
  В форме надо создать элемент формы и установить для него путь к данным. Реквизит отдельно создавать не надо, так как мы его добавили в документОбъект на уровне метаданных.
</details>
<details>
  <summary>Подсказка 8</summary>
  Конечно, программный код можно прописать в модуле формы, и для этого включить возможность изменения самой формы, но давайте обратим внимание, что все формы документов в событии ПриСозданииНаСервере вызывают одну и ту же процедуру общего модуля: 
  
  > ПодключаемыеКоманды.ПриСозданииНаСервере(ЭтотОбъект);
  
  Мы можем использовать это. «ЭтотОбъект» — это наша форма. Всё, что нам надо сделать, — включить возможность изменения для общего модуля, и из этой процедуры вызвать собственный общий модуль:
  <p align="center" width="100%">
    <img width="75%" src="img/HW_11_2_1.png"> 
  </p>
  
  А в самом этом модуле, исходя из имени формы, решать, как её доработать:
  <p align="center" width="100%">
    <img width="75%" src="img/HW_11_2_2.png"> 
  </p>
  
  Сам по себе этот способ может вызывать споры, т. к., с одной стороны, мы вносим корректировку в более универсальный механизм, с другой, — оставляем больше объектов на поддержке типовой конфигурации. Это удобнее, т. к. формы меняются чаще, чем подобные общие модули.
  
  Вы можете выбрать любой способ реализации, который вам больше нравится.
</details>
7. Убедитесь, что всё работает аналогично прошлому домашнему заданию.

## Задача 2. «Доработка программного кода в Конфигурации»

### Описание задачи
Задание аналогично второй задаче прошлого занятия, однако в этом случае необходимо сделать всё то же самое без использования расширения, внося корректировки в конфигурацию.
В этом задании основной проверяемый критерий — правильность внесения доработок.
Технические требования к реализации, а также порядок решения приведены в [прошлом домашнем задании](homework-11-1.md).

### Требования к результату
В документ «Заказ покупателя» должно быть добавлено поле «Согласованная скидка». Значение, указанное в поле, должно учитываться в документе.

### Процесс выполнения
1. Включите возможность изменения формы документа ЗаказПокупателя.
2. Добавьте в документ необходимый реквизит.
3. Доработайте форму необходимым образом.
<details>
  <summary>Подсказка 1</summary>
  Все объекты на форму должны быть добавлены программно.
</details>
<details>
  <summary>Подсказка 2</summary>
  Если в прошлом задании вы создали собственный общий модуль, пропишите добавление элементов в нём.
  
  Но обработчики событий должны располагаться в самой форме.
</details>
<details>
  <summary>Подсказка 3</summary>
  Не забывайте добавлять комментарии для выделения меняемого программного кода.
</details>

<details>
  <summary>Частые ошибки</summary>
  
  1. Учитывайте замечания из прошлой работы
  2. Не нужно дорабатыватьтакие обработчики, как "ТоварыКоличествоПриИзменении", "ТоварыЦенаПриИзменении" и т.п. Обратите внимание, все они вызывают одну функцию
  3. Если меняете стандартный метод (а по заданию это надо сделать) Менять его надо при помощи ИзменениеИКонтроль
  4. Выравнивайте только тот код, который Вы написали. Не следует пытаться выравнивать типовой код. Это усложнит дальнейшую поддержку, т.к. добавятся/удалятся невидимые символы - пробелы/табуляции и т.д., строка будет выглядеть, как измененная, хотя по факту такой не будет.
  5. При добавлении собственных методов в программный код, комментарий должен быть прописан **внутри метода, и в каждом методе** (то есть, в следующей строке, после "Процедура" или "Функция". Иначе, при обновлении, Вы не сможете отличить методы добавленные Вами при доработке, от методов, которые были удалены из типовой конфигурации поставщика.
  6. Заголовки для добавляемых элементов следует прописывать в "человекочитаемом" виде - с пробелами, т.е. не "ПеречсчитатьТаблицы", а "Пересчитать таблицы" (ВАЖНО это относится именно к заголовкам элементов, а не к их именам
  7. Реквизиты надо добавлять непосредственно в дерево конфигурации. Если вы создаете реквизит программно - он создается только в форме. То есть, информация никогда не сохранится в базе данных. Программно следует добавлять только элементы на форму, в данной задаче.
  8. Нельзя просто удалять или менять код типовой конфигурации. Исходный код обязательно должен быть сохранен в виде комментария (см. презентацию)
  9. Следует использовать единообразный стиль написания комментария. Например, если Вы начали использовать комментарий "// Начало. Иванов" - "// Конец. Иванов" - используйте такой же стиль везде. Это нужно еще и для того, чтобы Ваши доработки легко можно было бы найти в конфигурации глобальным поиском - 1 раз вводим в поиск строку "// Начало. Иванов" и сразу находим все места измененные Вами
  10. При доработке типового метода: с начала, лучше, написать комментарий с указанием автора и доработки, потом закомментировать исходный код типовой конфигурации, затем добавлять свой, новый
  11. Когда вы добавляете свой объект конфигурации (Справочник, Документ, Регистр) - дописываете префикс только к нему. У Реквизитов такого объекта префиксы уже можно не писать, т.к. и так понятно, что весь объект добавлен вами и все что в нем не имеет отношения к типовому коду
     
</details>

## Пример: 

В результате выполнения этого домашнего задания у вас должна получиться база с поведением, аналогичным [прошлому домашнему заданию](examples/HW_11_1_example.md).

------

### Критерии оценки

1. Зачёт — выполнены все задания, нет противоречий и нарушения логики. 
2. ВАЖНО! Введены тестовые данные. Проверьте все требования к заданию. Введите по меньшей мере 2 контрагентов, каждому из них по 2 контактных лица, 1 документ Заказ покупателя с указанием скидки и контактного лица. Значения должны сохраняться в базе, скидка должна применяться к сумме по строке табличной части в любом сценарии работы (изменение данных в строке, изменение реквизита, нажатие на кнопку)
3. На доработку — задание выполнено частично или не выполнено, в логике выполнения заданий есть противоречия, существенные недостатки.

*Примерное время выполнения: 45–180 минут*

Все задачи обязательны к выполнению. Пожалуйста, присылайте на проверку все задачи сразу.

Любые вопросы по решению задач задавайте в чате учебной группы.


