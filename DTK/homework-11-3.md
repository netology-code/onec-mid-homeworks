# Домашнее задание к занятию «Механизм поддержки, обновление»

## Цель задания

1. Научиться обновлять доработанные конфигурации. 
2. Научиться сравнивать обновление конфигурации, доработанной расширением, и конфигурации с изменениями непосредственно в коде.

Эта практика научит вас выполнять обновления измененных конфигураций 1С с сохранением доработок. Эти навыки важны для реальной работы, когда вы сопровождаете заказчика и выходит очередное обновление типовой конфигурации.

## Чеклист готовности к домашнему заданию

- [ ] Установить платформу версии 8.3.27 или больше.
- [ ] Просмотреть материал занятия «Механизм поддержки, обновление».
- [ ] Выполнить две прошлые домашние работы.

## Инструкция к заданию

1. Решите описанные задачи в конфигураторе.
2. Протестируйте решение в пользовательском режиме.
3. Для первой задачи: отправьте в личном кабинете Нетологии скриншот выбранной вами внешней программы для трёхстороннего сравнения.
4. Для второй и третьей задач: необходимо выслать файлы баз данных (.dt) с выполненным заданием, для каждой задачи свой файл.

## Задача 1. «Установка внешней программы для трёхстороннего сравнения»

### Описание задачи
Для упрощения выполнения обновления вам необходимо скачать и установить одну из программ для трёхстороннего сравнения.

### Требования к результату
Напишите название выбранной программы и приложите скриншот с окном сравнения модулей в выбранной программе. Сделать скриншот будет можно при выполнении третьей задачи.

### Процесс выполнения
1. Перейдите по [ссылке](https://wonderland.v8.1c.ru/blog/razvitie-sravneniya-obedineniya-moduley/). Ещё раз прочитайте информацию о трёхстороннем сравнении.
2. Попробуйте установить разные программы и выберите наиболее удобную для себя.
<details>
  <summary>Подсказка</summary>
  Наиболее популярными являются Kdiff3 и Perforce P4Merge. Вероятно, вам они могут приглянуться.
</details>

3. Установите программы и выберите наиболее удобную для себя.
4. Выполните обновление конфигурации, для сравнения модулей используйте внешнюю программу (удобно будет выполнять этот пункт, когда перейдёте к третьей задаче).
5. Сделайте скриншот, на котором будет видно сравнение модулей старой и новой конфигураций через внешнюю программу.

## Задача 2. «Обновление конфигурации с расширением»

### Описание задачи
Нам необходимо выполнить обновление конфигурации, при этом сохранить работоспособность дописанного для неё расширения.

### Требования к результату
Конфигурация с новой версией, при этом должен работать как добавленный в расширении функционал, так и функционал из новой версии конфигурации.

### Процесс выполнения
1. Сохраните результат прошлого домашнего задания в отдельный dt-файл.
2. Разверните dt-файл с базой-результатом [первого задания этого модуля](homework-11-1.md).
3. Скачайте обновление для конфигурации [по ссылке](src/update.cfu).
4. Выполните обновление конфигурации.
5. При необходимости найдите проблемы в расширении и устраните их.
<details>
  <summary>Подсказка 1</summary>
  Так как конфигурация находится на полной поддержке, при выполнении обновления никаких дополнительных окон не появится. 1С просто сообщит, что конфигурация обновлена.
</details>
<details>
  <summary>Подсказка 2</summary>
  Запустите приложение в пользовательском режиме и проверьте, что тот функционал, который вы дорабатывали, продолжает работать.
</details>
<details>
  <summary>Подсказка 3</summary>
  В справочнике Контрагенты появилась табличная часть «Приобретённая номенклатура», но это никак не пересекается с вашими доработками (если вы не добавляли на форму Контрагентов отдельных команд и полей для работы с Контактными лицами).
</details>
<details>
  <summary>Подсказка 4</summary>
  При открытии формы документа «Заказ покупателя», можно увидеть предупреждение, что возник конфликт с расширением. Теперь при изменении строки применяется только скидка, указанная в табличной части, но скидка, указанная в шапке документа, игнорируется. Надо доработать расширение так, чтобы скидки суммировались, но при этом не превышали 100%.
</details>
<details>
  <summary>Подсказка 5</summary>
  Перенесите в блок «Удаление» новый код и дополните свой код в блоке Вставка так, чтобы считывался процент из табличной части.
</details>

6. Убедитесь, что всё работает корректно.


7. Выгрузите файл базы данных (.dt) и отправьте его на проверку.

## Задача 3. «Обновление конфигурации с изменениями, внесенными в конфигурацию непосредственно»

### Описание задачи
Нам необходимо выполнить обновление конфигурации, при этом сохранить работоспособность изменённого программного кода.

### Требования к результату
Конфигурация с новой версией, при этом должен работать как доработанный функционал, так и функционал из новой версии конфигурации.

### Процесс выполнения
1. Разверните dt-файл с базой-результатом [второго задания этого модуля](homework-11-2.md).
2. Используя тот же файл обновления, выполните обновление.
3. В отличие от прошлой задачи, тут мы сразу увидим, какие объекты изменились. Обработайте изменения.
<details>
  <summary>Подсказка 1</summary>
  Используйте режим «Показывать только дважды измененные свойства», чтобы не анализировать лишнее.
</details>
<details>
  <summary>Подсказка 2</summary>
  Сделайте скриншот с программой трёхстороннего сравнения.
</details>
<details>
  <summary>Подсказка 3</summary>
  В форме документа поменялся программный код. Убедитесь, что с добавленных вами процедур сняты флажки (чтобы они не удалились).
  
  При этом на всех процедурах, которые добавлены в модуль, флажки должны стоять.
</details>
<details>
  <summary>Подсказка 5</summary>
  Некоторые процедуры как будто не изменились. Однако они были перенесены в новые области кода. Сохраните эти изменения.
</details>
<details>
  <summary>Подсказка 4</summary>
  Доработайте процедуру расчёта строки.
</details>

После обновления, проверьте модуль: Служебные комментарии "MRG" после обновления не должны оставаться в нем. Модуль должен выглядеть, как если бы вы просто доработали его. Т.е. должен быть типовой код поставщика и ваши доработки. Закомментирован должен быть код текущей версии конфигурации. Ничего лишнего в модуле быть не должно.

4. Убедитесь, что всё работает корректно.

5. Выгрузите файл базы данных (.dt) и отправьте его на проверку.

## Пример: [пример работы конфигурации после корректного обновления](examples/HW_11_3_example.md)

------

### Критерии оценки

1. Зачёт — выполнены все задания, нет противоречий и нарушения логики. 
2. ВАЖНО! Протестируйте решение. Во всех сценариях скидки должны применяться совместно. Но в случае если суммарная скидка превышает 100%, Сумма по строке должна быть установлена 0, пользователь должен получить сообщение.
3. На доработку — задание выполнено частично или не выполнено, в логике выполнения заданий есть противоречия, существенные недостатки.

*Примерное время выполнения: 45–180 минут*

Все задачи обязательны к выполнению. Пожалуйста, присылайте на проверку все задачи сразу.



