# Домашнее задание к занятию «Механизмы печати»

### Цель задания

1. Научиться формировать печатные формы с помощью БСП:
    - с выводом QR-кодов,
    - с печатью комплекта документов,
    - в формате .docx.

### Чеклист готовности к домашнему заданию

- [ ] Установить платформу версии 8.3.25 или больше.
- [ ] Подготовить информационную базу, полученную по итогу выполнения [домашнего задания к занятию 12-1](homework-12-1.md).


### Инструкция к заданию

1. Решите описанные задачи в конфигураторе.
2. Протестируйте решение в пользовательском режиме.
3. В личном кабинете Нетологии отправьте на проверку один общий файл базы данных (.dt), содержащий решение по всем 3 задачам. Файл прикрепите в раздел «решение» в практическом задании.

## Задание 1. «Печать Анкеты клиента и Транспортной накладной»

### Описание задачи
По заданию заказчика вы реализуете печатные формы Анкета клиента и Транспортная накладная для документа Доставка.

### Требования к результату
У документа Доставка в форме документа и форме списка должны выводиться команды на печать Анкеты клиента и Траспортной накладной.
При нажатии на команды должны формироваться печатные формы в соответствии с предоставленными макетами. В правом верхнем углу печатной формы должен выводиться QR-код с внутренней ссылкой на документ.
Должна быть предусмотрена массовая печать документов.

### Процесс выполнения
1. Ознакомьтесь с шаблонами печатных форм [Анкеты клиента](src/questionary.xlsx) и [Товарной накладной](src/transport.xlsx).
2. Создайте макеты для документа Доставка в соответствии с шаблонами.
3. В общем модуле УправлениеПечатьюПереопределяемый в методе ПриОпределенииОбъектовСКомандамиПечати добавьте информацию о документе Доставка.
4. В модуле менеджера документа Доставка реализуйте алгоритм вывода команд печати и алгоритм печати. В качестве образца можно использовать алгоритм из документа Заказ покупателя.
5. Для вывода QR-кода в печатную форму:
    - добавьте в макет в нужную область рисунок, задайте ему подходящее по смыслу имя;
    - в алгоритме печати сформируйте QR-код:
    ```bsl
	ДанныеQRКода = ГенерацияШтрихкода.ДанныеQRКода(СсылкаНаДокумент, 1, 120);
    ```
    - проверьте, что QR-код сформирован успешно и выведите его в документ:
    ```bsl
    Если НЕ ТипЗнч(ДанныеQRКода) = Тип("ДвоичныеДанные") Тогда
        ТекстСообщения = НСтр("ru = 'Не удалось сформировать QR-код.
                    |Технические подробности см. в журнале регистрации.'");
        ОбщегоНазначения.СообщитьПользователю(ТекстСообщения);
    Иначе
        КартинкаQRКода = Новый Картинка(ДанныеQRКода);
        Область.Рисунки.ИмяРисунка.Картинка = КартинкаQRКода;
    КонецЕсли;		
    ```

### Результат задания
1. Запустите базу в пользовательском режиме.
2. Убедитесь, что на форме документа и на форме списка документа Доставка в панели действий отображаются команды печати.
3. Убедитесь, что печатные формы формируются корректно, в том числе формируется QR-код и работает множественная печать.

## Задание 2. «Печать комплекта документов»

### Описание задачи
По заданию заказчика вы реализуете возможность печати Анкеты клиента и Транспортной накладной в виде комплекта документов одной кнопкой.

### Требования к результату
У документа Доставка в форме документа и форме списка должны выводиться команда Комплект документов.
При нажатии на команды должен формироваться комплект документов, состоящий из Анкеты клиента и Транспортной накладной.
Должна быть предусмотрена массовая печать документов.

### Процесс выполнения
Добавьте команду печати для вывода комплекта документов в модуле мендежера документа Доставка. В качестве образца можно использовать команду вывода комплекта из документа Заказ покупателя.

### Результат задания
1. Запустите базу в пользовательском режиме.
2. Убедитесь, что на форме документа и на форме списка документа Доставка в панели действий отображается команда печати комплекта.
3. Убедитесь, что печатные формы формируются корректно.

## Задание 3. «Печать договора на доставку»

### Описание задачи
По заданию заказчика вы реализуете возможность печати Договора на доставку в формате .docx.

### Требования к результату
У документа Доставка в форме документа и форме списка должны выводиться команда Договор на доставку.
При нажатии на команды должна формироваться печатная форма в формате .docx средствами БСП.

### Процесс выполнения
1. Ознакомьтесь с шаблоном печатной формы [Договор на доставку](src/contract.docx).
2. Добавьте в конфигурацию реквизиты, необходимые для заполнения полей печатной формы. 
    * Для хранения части реквизитов можно использовать подсистему свойства.
3. Подготовьте на основе шаблона печатной формы макет для печати средствами БСП в пользовательском режиме.
4. Добавьте макет в конфигурацию. _(Важно! Если печатная форма будет добавлена в пользовательском режиме, решение будет отправлено на доработку. Макет должен быть добавлен в конфигурацию)_
5. Добавьте команду для формирования печатной формы из добавленного макета.

Минимально, в договоре должны быть заполнены: Дата и Номер договора, Отправитель (Организация из документа), Перевозчик (Контрагент), их ИНН и КПП, а так же юридический и почтовый адрес (по контактной информации из справочника)

Минимально, в договоре должны быть заполнены - Дата договора, Отправитель (Организация из документа), Перевозчик (Контрагент), их ИНН и КПП, а так же юридический и почтовый адрес

### Результат задания
1. Запустите базу в пользовательском режиме.
2. Убедитесь, что на форме документа и на форме списка документа Доставка в панели действий отображается команда печати Договора.
3. Убедитесь, что печатная форма формируется корректно.

### Критерии оценки

1. Зачёт — выполнены все задания, в выполненных заданиях нет противоречий и нарушения логики. Введены тестовые данные на каждую задачу, демонстрирующие ее полную работоспособность 
2. На доработку — задание выполнено частично или не выполнено, в логике выполнения заданий есть противоречия, существенные недостатки. Нет тестовых данных

Все задачи обязательны к выполнению. Пожалуйста, присылайте на проверку все задачи сразу.

Любые вопросы по решению задач задавайте в чате учебной группы.

*Примерное время выполнения: 45–240 минут*
