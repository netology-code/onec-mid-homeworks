# Домашнее задание к занятию «Программный интерфейс»

### Цель задания

Научиться использовать программный интерфейс БСП для решения задач:
- вывод сообщений,
- получение текущего пользователя,
- получение данных из базы,
- выполнение длительных операций в фоне.

### Чеклист готовности к домашнему заданию

- [ ] Установить платформу версии 8.3.27 или больше.
- [ ] Подготовить информационную базу, полученную по итогу выполнения [домашнего задания к занятию 12-1](homework-12-1.md).

## Инструкция к заданию

1. Скачайте [расширение с заданием](homework-12-2.cfe).
2. Установите в информационную базу.
3. Выполните задание в конфигураторе.
4. Протестируйте решение в пользовательском режиме.
5. В личном кабинете Нетологии отправьте на проверку один доработанный файл расширения (.cfe), содержащий решение по всем 2 задачам. Файл прикрепите в раздел «решение» в практическом задании.

### Задание 1. «Рефакторинг существующего кода»

### Описание задачи
Вам передали расширение предыдущего разработчика, который не использовал БСП в своей работе. Вы хотите максимально задействовать БСП в работе алгоритмов расширения.

### Требования к результату
В обработке «ДЗ_12_2_АлгоритмыДляРефакторинга» в командах «ПрочитатьКонтрагентаДоговор», «ПроверитьGUID», «СообщитьТекущегоПользователя» и «ОткрытьСайтНетологии» необходимо максимально заменить свой код на вызов методов из БСП, подходящих по смыслу.

### Процесс выполнения
1. Изучите алгоритм работы перечисленных команд.
2. Выделите участки алгоритмов, которые можно заменить на вызовы методов БСП.
3. Выполните замену.
4. Протестируйте корректность работы команд после замены.

### Результат задания
1. Запустите базу в пользовательском режиме.
2. Убедитесь, что команды работают так же, как и до рефакторинга.

### Задание 2. «Реализация выполнения тяжёлой операции в фоне»

### Описание задачи
Вы продолжаете рефакторить расширение и хотите вынести выполнение тяжёлой операции в фон.

### Требования к результату
В обработке «ДЗ_12_2_АлгоритмыДляРефакторинга» в команде «ВыполнитьТяжелуюОперацию» выполните запуск фонового задания, ожидание результата и последующего вывода результата пользователю. Для решения задачи необходимо использовать ДлительныеОперации БСП.

### Процесс выполнения
1. На сервере замените прямой вызов функции из модуля менеджера обработки на вызов `ДлительныеОперации.ВыполнитьФункцию` с передачей имени функции. Верните на клиент информацию о запущенной длительной операции. (Сам модуль менеджера обработки менять нельзя)
2. На клиенте запустите ожидание длительной операции с помощью `ДлительныеОперацииКлиент.ОжидатьЗавершение`, передавая ОписаниеОповещения.
3. В методе, куда передаёт управление ОписаниеОповещения, получите результат работы из временного хранилища и выведите пользователю.

(ВАЖНО!) Саму функцию в модуле менеджера обработки менять нельзя. Она должна остаться в том же виде.

### Результат задания
1. Запустите базу в пользовательском режиме.
2. Убедитесь, что тяжёлая операция выполняется в фоне, на время выполнения открывается форма ожидания.

<details>
  <summary>Частые ошибки</summary>
  
  1. Для проверки уникального идентификатора, в БСП есть специальный метод. Оставлять конструкцию Попытка-Исключение - не верно
  2. Переменные и результат функций с типом Булево в условиях не сравнивают с "Истина".
  3. Все сообщения следует выводить методами БСП.
  4. Рефакторинг (исправление, оптимизация) программного кода не должен приводить к изменению результата работы для пользователя, т.е. если раньше результат тяжелой функции выводился таким сообщением "Результат тяжелой операции: %1", то и после ваших доработок, должен выводиться так же.
  5. В `ПрочитатьКонтрагентаДоговорНаСервере` - следует использовать метод, который за один вызов вернет несколько свойств.

</details>

### Критерии оценки

1. Зачёт — выполнены все задания, в выполненных заданиях нет противоречий и нарушения логики. 
2. На доработку — задание выполнено частично или не выполнено, в логике выполнения заданий есть противоречия, существенные недостатки.

Все задачи обязательны к выполнению. Пожалуйста, присылайте на проверку все задачи сразу.



*Примерное время выполнения: 45–120 минут*
